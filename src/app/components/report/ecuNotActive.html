<section class="content-header">
  <h1>
    <small></small>
  </h1>
  <ol class="breadcrumb">
    <li><a href="#"><i class="fa fa-dashboard"></i> 主页</a></li>
    <li class="active">ECU未激活车辆</li>
  </ol>
</section>

<!-- Main content -->
<section class="content form-horizontal">
  <div class="row form-group">
    <div class="btn-group col-md-2">
      <span class="label label-info pull-left">总数:{{ecuNotActiveCtrl.page.totalElements}}</span>
    </div>
    <div class="col-md-offset-8 col-md-2 text-right">
      <a class="btn btn-default" title="Export Table" ng-click='ecuNotActiveCtrl.excelExport()' presentation-href="report:ecuNotActive">{{'export'|translate}}</a>
    </div>
  </div>

  <div class="table-responsive">
    <table ng-table="ecuNotActiveCtrl.tableParams" class="table table-condensed table-bordered table-striped text-nowrap">
      <tr ng-repeat="device in $data">
        <td class="text-nowrap" data-title="'终端编号'" sortable="'deviceNum'">{{device.deviceNum}}</td>
        <td class="text-nowrap" data-title="'整机编号'" sortable="'machine.licenseId'">{{device.machine.licenseId}}</td>

        <td class="text-nowrap" ng-if="device.lockerStatus=='00'" data-title="'开盖状态'" sortable="'lockerStatus'">未开盖</td>
        <td class="text-nowrap" ng-if="device.lockerStatus=='11'" data-title="'开盖状态'" sortable="'lockerStatus'">开盖</td>
        <td class="text-nowrap" ng-if="device.lockerStatus==null" data-title="'开盖状态'" sortable="'lockerStatus'">-</td>

        <td class="text-nowrap" data-title="'运行总时间'" sortable="'totalDuration'">{{device.totalDuration * 0.05 | convertToMins}}</td>

        <td class="text-nowrap" ng-if="device.commStatus=='10'" data-title="'CAN通信状态'" sortable="'commStatus'">不工作</td>
        <td class="text-nowrap" ng-if="device.commStatus=='01'" data-title="'CAN通信状态'" sortable="'commStatus'">工作</td>
        <td class="text-nowrap" ng-if="device.commStatus=='00' || device.commStatus==null" data-title="'CAN通信状态'" sortable="'commStatus'">-</td>

        <td class="text-nowrap" ng-if="device.powerType=='00'" data-title="'供电方式'" sortable="'powerType'">{{'vehicleMountedPowerSupply'|translate}}</td>
        <td class="text-nowrap" ng-if="device.powerType=='01'" data-title="'供电方式'" sortable="'powerType'">{{'internalBattery'|translate}}</td>
        <td class="text-nowrap" ng-if="device.powerType==null" data-title="'供电方式'" sortable="'powerType'">-</td>

        <td class="text-nowrap" data-title="'GPRS信号质量'" sortable="'gsmSignal'">{{(device.gsmSignal*100/31) | number:0}}%</td>
        <td class="text-nowrap" data-title="'启动次数'" sortable="'startTimes'">{{device.startTimes}}</td>

        <td class="text-nowrap" ng-if="device.versionNum!='40' && device.lockStatus=='00'" data-title="'锁车状态'" sortable="'lockStatus'">正常</td>
        <td class="text-nowrap" ng-if="device.versionNum!='40' && device.lockStatus=='01'" data-title="'锁车状态'" sortable="'lockStatus'">一级</td>
        <!--锁车时候显示“二级”更改为“锁车”-->
        <td class="text-nowrap" ng-if="device.versionNum!='40' && device.lockStatus=='10'" data-title="'锁车状态'" sortable="'lockStatus'">锁车</td>
        <td class="text-nowrap" ng-if="device.versionNum!='40' && device.lockStatus!='00' && device.lockStatus!='01' && device.lockStatus!='10'" data-title="'锁车状态'" sortable="'lockStatus'">-</td>
        <!--中挖的锁车状态要根据GPRS信号百分比确定，90为锁车，其它为未锁车-->
        <td class="text-nowrap" ng-if="device.versionNum=='40' && device.gprsSignal=='90'" data-title="'锁车状态'" sortable="'gprsSignal'">锁车</td>
        <td class="text-nowrap" ng-if="device.versionNum=='40' && device.gprsSignal!='90'" data-title="'锁车状态'" sortable="'gprsSignal'">正常</td>

        <td class="text-nowrap" data-title="'内部电源电压'" sortable="'imitate1'">{{device.imitate1/1000| number:1}} V</td>
        <td class="text-nowrap" data-title="'可见卫星数'" sortable="'visibleSatelliteNumber'">{{device.visibleSatelliteNumber}}</td>
        <td class="text-nowrap" data-title="'可用卫星数'" sortable="'usableSatelliteNumber'">{{device.usableSatelliteNumber}}</td>
        <td class="text-nowrap" data-title="'实际绑定车架号'" sortable="'bindMachineId'">{{device.bindMachineId}}</td>
        <td class="text-nowrap" data-title="'当前位置'" sortable="'address'">{{device.address}}</td>

        <td class="text-nowrap" ng-if="device.locateStatus=='A'" data-title="'定位时间'" sortable="'locateDateTime'">{{device.locateDateTime | date:'yyyy-MM-dd HH:mm:ss'}}</td>
        <td class="text-nowrap" ng-if="device.locateStatus=='V'||device.locateStatus == null" data-title="'定位时间'" sortable="'locateDateTime'">-</td>
        <td class="text-nowrap" data-title="'回传时间'" sortable="'lastDataUploadTime'">{{device.lastDataUploadTime | date:'yyyy-MM-dd HH:mm:ss'}}</td>
      </tr>
    </table>
  </div>
  </div>

  <div class="box-footer">
    <uib-pagination total-items="ecuNotActiveCtrl.page.totalElements"
                    ng-change="ecuNotActiveCtrl.query(ecuNotActiveCtrl.pageNumber-1,null,null,null)"
                    max-size="5" ng-model="ecuNotActiveCtrl.pageNumber" items-per-page="ecuNotActiveCtrl.page.size"
                    class="pagination-sm" boundary-links="true" rotate="false"
                    first-text="{{'pagingHomePage' | translate}}" last-text="{{'lastPage'|translate}}" next-text="{{'nextPage'|translate}}" previous-text="{{'previousPage'|translate}}">
    </uib-pagination>
  </div>

</section>
