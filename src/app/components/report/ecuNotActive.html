<section class="content-header">
  <h1>
    <small></small>
  </h1>
  <ol class="breadcrumb">
    <li><a href="#"><i class="fa fa-dashboard"></i> {{'statisticalAnalysis'|translate}}</a></li>
    <li class="active">{{'ECUInactiveMachine'|translate}}</li>
  </ol>
</section>

<!-- Main content -->
<section class="content form-horizontal">
  <div class="row form-group">
    <div class="btn-group col-md-2">
      <span class="label label-info pull-left">总数:{{ecuNotActiveCtrl.page.totalElements}}</span>
    </div>
    <div class="col-md-offset-8 col-md-2 text-right">
      <a class="btn btn-default" title="Export Table" ng-click='ecuNotActiveCtrl.excelExport()' presentation-href="report:ecuNotActive">{{'export'|translate}}</a>
    </div>
  </div>

  <div class="table-responsive">
    <table ng-table="ecuNotActiveCtrl.tableParams" class="table table-condensed table-bordered table-striped text-nowrap">
      <tr ng-repeat="device in $data">
        <td class="text-nowrap" data-title="'deviceNum'|translate" sortable="'deviceNum'">{{device.deviceNum}}</td>
        <td class="text-nowrap" data-title="'machineNumberAndCarNumber'|translate" sortable="'machine.licenseId'">{{device.machine.licenseId}}</td>

        <td class="text-nowrap" ng-if="device.lockerStatus=='00'" data-title="'openCoverState'|translate" sortable="'lockerStatus'">{{'notOpen'|translate}}</td>
        <td class="text-nowrap" ng-if="device.lockerStatus=='11'" data-title="'openCoverState'|translate" sortable="'lockerStatus'">{{'openCover'|translate}}</td>
        <td class="text-nowrap" ng-if="device.lockerStatus==null" data-title="'openCoverState'|translate" sortable="'lockerStatus'">-</td>

        <td class="text-nowrap" data-title="'totalRunningTimeHour'|translate" sortable="'totalDuration'">{{device.totalDuration * 0.05 | convertToMins}}</td>

        <td class="text-nowrap" ng-if="device.commStatus=='10'" data-title="'CANCommunicationStatus'|translate" sortable="'commStatus'">{{'notWork'|translate}}</td>
        <td class="text-nowrap" ng-if="device.commStatus=='01'" data-title="'CANCommunicationStatus'|translate" sortable="'commStatus'">{{'work'|translate}}</td>
        <td class="text-nowrap" ng-if="device.commStatus=='00' || device.commStatus==null" data-title="'CANCommunicationStatus'|translate" sortable="'commStatus'">-</td>

        <td class="text-nowrap" ng-if="device.powerType=='00'" data-title="'powerSupplyMode'|translate" sortable="'powerType'">{{'vehicleMountedPowerSupply'|translate}}</td>
        <td class="text-nowrap" ng-if="device.powerType=='01'" data-title="'powerSupplyMode'|translate" sortable="'powerType'">{{'internalBattery'|translate}}</td>
        <td class="text-nowrap" ng-if="device.powerType==null" data-title="'powerSupplyMode'|translate" sortable="'powerType'">-</td>

        <td class="text-nowrap" data-title="'GPRSSignalQuality'|translate" sortable="'gsmSignal'">{{(device.gsmSignal*100/31) | number:0}}%</td>
        <td class="text-nowrap" data-title="'numberOfStarts'|translate" sortable="'startTimes'">{{device.startTimes}}</td>

        <td class="text-nowrap" ng-if="device.versionNum!='40' && device.lockStatus=='00'" data-title="'lockedCarStatus'|translate" sortable="'lockStatus'">{{'normal'|translate}}</td>
        <td class="text-nowrap" ng-if="device.versionNum!='40' && device.lockStatus=='01'" data-title="'lockedCarStatus'|translate" sortable="'lockStatus'">{{'one-level'|translate}}</td>
        <!--锁车时候显示“二级”更改为“锁车”-->
        <td class="text-nowrap" ng-if="device.versionNum!='40' && device.lockStatus=='10'" data-title="'lockedCarStatus'|translate" sortable="'lockStatus'">{{'lockYourCar'|translate}}</td>
        <td class="text-nowrap" ng-if="device.versionNum!='40' && device.lockStatus!='00' && device.lockStatus!='01' && device.lockStatus!='10'" data-title="'lockedCarStatus'|translate" sortable="'lockStatus'">-</td>
        <!--中挖的锁车状态要根据GPRS信号百分比确定，90为锁车，其它为未锁车-->
        <td class="text-nowrap" ng-if="device.versionNum=='40' && device.gprsSignal=='90'" data-title="'lockedCarStatus'|translate" sortable="'gprsSignal'">{{'lockYourCar'|translate}}</td>
        <td class="text-nowrap" ng-if="device.versionNum=='40' && device.gprsSignal!='90'" data-title="'lockedCarStatus'|translate" sortable="'gprsSignal'">{{'normal'|translate}}</td>

        <td class="text-nowrap" data-title="'GPSPowerDetection'|translate" sortable="'imitate1'">{{device.imitate1/1000| number:1}} V</td>
        <td class="text-nowrap" data-title="'visibleSatelliteNumber'|translate" sortable="'visibleSatelliteNumber'">{{device.visibleSatelliteNumber}}</td>
        <td class="text-nowrap" data-title="'usableSatelliteNumber'|translate" sortable="'usableSatelliteNumber'">{{device.usableSatelliteNumber}}</td>
        <td class="text-nowrap" data-title="'bindMachineId'|translate" sortable="'bindMachineId'">{{device.bindMachineId}}</td>
        <td class="text-nowrap" data-title="'currentPosition'|translate" sortable="'address'">{{device.address}}</td>

        <td class="text-nowrap" ng-if="device.locateStatus=='A'" data-title="'positioningTime'|translate" sortable="'locateDateTime'">{{device.locateDateTime | date:'yyyy-MM-dd HH:mm:ss'}}</td>
        <td class="text-nowrap" ng-if="device.locateStatus=='V'||device.locateStatus == null" data-title="'positioningTime'|translate" sortable="'locateDateTime'">-</td>
        <td class="text-nowrap" data-title="'returnTime'|translate" sortable="'lastDataUploadTime'">{{device.lastDataUploadTime | date:'yyyy-MM-dd HH:mm:ss'}}</td>
      </tr>
    </table>
  </div>
  </div>

  <div class="box-footer">
    <uib-pagination total-items="ecuNotActiveCtrl.page.totalElements"
                    ng-change="ecuNotActiveCtrl.query(ecuNotActiveCtrl.pageNumber-1,null,null,null)"
                    max-size="5" ng-model="ecuNotActiveCtrl.pageNumber" items-per-page="ecuNotActiveCtrl.page.size"
                    class="pagination-sm" boundary-links="true" rotate="false"
                    first-text="{{'pagingHomePage' | translate}}" last-text="{{'lastPage'|translate}}" next-text="{{'nextPage'|translate}}" previous-text="{{'previousPage'|translate}}">
    </uib-pagination>
  </div>

</section>
